var webs = [{
	"n": "默认",
	"g": "navmr",
	"web": [{
		"n": "百度",
		"u": "https://www.baidu.com",
		"self": true,
		"hide": true
	},  {
		"n": "谷歌学术",
		"u": "https://scholar.google.com"
	}, {
		"n": "百度学术",
		"u": "http://xueshu.baidu.com"
	}, {
		"n": "新浪微博",
		"u": "http://weibo.com",
		"tile": "wb"
	}, {
		"n": "百度贴吧",
		"u": "http://tieba.baidu.com"
	}, {
		"n": "燕山大学吧",
		"u": "http://tieba.baidu.com/f?kw=%D1%E0%C9%BD%B4%F3%D1%A7&fr=index"
	}, {
		"n": "知乎",
		"u": "http://www.zhihu.com"
	}, {
		"n": ">>招聘求职",
		"u": "campus.html"
	}]
}, {
	"n": "翻译·论文",
	"g": "navfy",
	"web": [{
		"n": "Google翻译",
		"u": "http://translate.google.cn/"
	}, {
		"n": "有道翻译",
		"u": "http://fanyi.youdao.com/"
	}, {
		"n": "必应翻译",
		"u": "http://www.bing.com/translator/"
	}, {
		"n": "中国知网",
		"u": "http://epub.cnki.net/kns/default.htm"
	}, {
		"n": "维普期刊",
		"u": "http://lib.cqvip.com/"
	}, {
		"n": ">>更多数据库",
		"u": "http://library.ysu.edu.cn/sourceRight.aspx?caid=0&title=&parentID="
	}]
}, {
	"n": "燕大",
	"g": "navyd",
	"web": [{
		"n": "图书馆",
		"u": "http://library.ysu.edu.cn",
		"tile": "tsg"
	}, {
		"n": "燕大新闻",
		"u": "http://news.ysu.edu.cn/"
	}, {
		"n": "研究生院",
		"u": "http://gs.ysu.edu.cn/"
	}, {
		"n": "信息学院",
		"u": "http://ise.ysu.edu.cn/queryMainServlet.do"
	}, {
		"n": "招生就业处",
		"u": "http://zsc.ysu.edu.cn/"
	}, {
		"n": "校园一卡通",
		"u": "http://ecard.ysu.edu.cn/",
		"tile": "nh"
	}, {
		"n": "校园直播",
		"u": "http://yit.ysu.edu.cn/dmtfw/dszb/CCTV1.htm",
		"tile": "zb"
	}, {
		"n": "博云资料",
		"u": "http://202.206.242.26:88/poweb/index.jsp"
	}, {
		"n": ">>燕大主页",
		"u": "http://www.ysu.edu.cn"
	}]
}, {
	"n": "视频",
	"g": "navsp",
	"web": [{
		"n": "优酷",
		"u": "http://www.youku.com/"
	}, {
		"n": "爱奇艺",
		"u": "http://www.iqiyi.com/"
	}, {
		"n": "腾讯视频",
		"u": "http://v.qq.com/"
	}, {
		"n": "土豆",
		"u": "http://www.tudou.com/"
	}, {
		"n": "乐视",
		"u": "http://www.letv.com/"
	}, {
		"n": "哔哩哔哩",
		"u": "http://www.bilibili.tv/"
	}]
}, {
	"n": "公开课",
	"g": "navgkk",
	"web": [{
		"n": "网易公开课",
		"u": "http://open.163.com/"
	}, {
		"n": "MOOC学院",
		"u": "http://mooc.guokr.com/"
	}, {
		"n": "Coursera",
		"u": "https://www.coursera.org/",
		"tile": "ca"
	}, {
		"n": "edX",
		"u": "https://www.edx.org/"
	}, {
		"n": "Stanford Online",
		"u": "http://online.stanford.edu/"
	}, {
		"n": "优课联盟",
		"u": "http://ysdx.benke.chaoxing.com/"
	}, {
		"n": "极客学院",
		"u": "http://www.jikexueyuan.com/"
	}]
}, {
	"n": "门户·新闻",
	"g": "navmx",
	"web": [{
		"n": "新浪门户",
		"u": "http://www.sina.com.cn/"
	}, {
		"n": "搜狐门户",
		"u": "http://www.sohu.com/"
	}, {
		"n": "腾讯门户",
		"u": "http://www.qq.com/"
	}, {
		"n": "网易门户",
		"u": "http://www.163.com/"
	}, {
		"n": "新浪新闻",
		"u": "http://news.sina.com.cn/"
	}, {
		"n": "凤凰新闻",
		"u": "http://news.ifeng.com/"
	}]
}, {
	"n": "生活",
	"g": "navsh",
	"web": [{		
		"n": "12306",
		"u": "http://www.12306.cn/"
	}, {
		"n": "工商银行",
		"u": "http://www.icbc.com.cn/"
	}, {
		"n": "农业银行",
		"u": "http://www.abchina.com/",
	}, {
		"n": "中国移动",
		"u": "http://www.10086.cn/"
	}, {
		"n": "中国电信",
		"u": "http://www.189.cn/"
	}, {
		"n": "中国联通",
		"u": "http://www.10010.com/"
	}]
}, {
	"n": "购物",
	"g": "navgw",
	"web": [{
		"n": "淘宝",
		"u": "http://www.taobao.com",
	}, {
		"n": "淘宝特卖",
		"u": "http://temai.taobao.com/event9776.htm?pid=mm_34619426_10544719_34746681",
		"tile": "tb"
	}, {
		"n": "天猫精选",
		"u": "http://s.click.taobao.com/JVTYq1y?pid=mm_34619426_10544719_34746681",
		"tile": "tm"
	}, {
		"n": "9块9包邮",
		"u": "http://temai.taobao.com/event10323.htm?pid=mm_34619426_10544719_34746681"
	}, {
		"n": "聚划算",
		"u": "http://s.click.taobao.com/t?e=m%3D2%26s%3D2UAluaBvNwAcQipKwQzePCperVdZeJviEViQ0P1Vf2kguMN8XjClAst4v9AnmnxCFT4zOznvumHtZ%2FHkVmW9a5Rk9NkCYUOdfWCvxR1IcGx7q%2BImG02VulW00662PG2K8Cm%2FwUl4ESHcHtRpEUy6RLSgd9R%2Fv5WktY4Qt2cZ1lVeY%2By0blbhscYl7w3%2FA2kb"
	}, {
		"n": "美团",
		"u": "http://www.meituan.com/"
	}, {
		"n": "百度糯米",
		"u": "http://www.nuomi.com/"
	}, {
		"n": "聚美优品",
		"u": "http://www.jumei.com/"
	}, {
		"n": "唯品会",
		"u": "http://www.vip.com"
	}, {
		"n": "京东商城",
		"u": "http://www.jd.com"
	}, {
		"n": "当当",
		"u": "http://www.dangdang.com"
	}, {
		"n": "亚马逊",
		"u": "http://www.amazon.cn"
	}, {
		"n": "蘑菇街",
		"u": "http://www.mogujie.com"
	}, {
		"n": ">>好东西分享",
		"u": "http://www.xiaobaidonghui.cn/?cat=7"
	}]
}];

function gengrid() {
	$("#webgrid").empty();
	$("#tile").empty();
	
	/* 20150824 完善自适应 */
	var rcols = parseInt($("#webgrid").width() / 150);
	if(rcols<=3)
	{
		rcols=3;
	}
	else if(rcols == 5){
		rcols=7;
	}
	/*********************/	
	$.each(webs, function(n, value) {
		var webgroup = value.g;		
		var webgridtmp = '<div id="' + webgroup + '0" class="row cells' + rcols;
//		webgridtmp += getRowBgClass();
		webgridtmp += ' bg-hover-grayLighter';
		webgridtmp += '"><span class="cell" align="center">' + value.n + '</span></div>'
		$("#webgrid").append(webgridtmp);
		

		var webid = 0;
		$.each(value.web, function(n, value) {
			if (value.tile == undefined) {
				if (value.hide == undefined) {
					webid++;
					var rowid = parseInt(webid / rcols);
					if (webid % rcols == 0) {
						$("#" + webgroup + (rowid - 1)).after('<div id="' + webgroup + rowid + '" class="row cells' + rcols + ' bg-hover-grayLighter"><span class="cell" align="center"></span></div>');
						webid++;
					}
					$("#" + webgroup + rowid).append('<div class="cell"><a href="' + value.u + '" target="_blank">' + value.n + '</a></div>');
				}
			} else {
				$("#tile").append(getTile(value.u, 'http://wpxbdh.oss-cn-beijing.aliyuncs.com/ysu123%2Fimg%2F' + value.tile + '.png', value.n));
			}
		});
	});
};

function getTile(url, img, text) {
	return '<div rel="tile" class="tile fg-white" onclick="openTile(\'' + url + '\')"><div class="tile-content slide-up"><div class="slide"><div class="image-container image-format-square" style="width: 100%;"><div class="frame" style="background-position: center; background-image: url(' + img + '); background-size: auto; background-repeat: no-repeat;"></div></div></div>   </div></div>'
	//<div class="slide-over op-cyan text-small padding10">' + text + '</div>
}

function openTile(tileurl) {
	window.open(tileurl, "_blank");
}

$(window).resize(function() {
	gengrid();
});


$(document).ready(function() {
	$.each(webs, function(n, value) {
		var normalNode;
		var group = value.g;
		$("#navmain").append('<li class="navlicustomcss"><a href="#">' + value.n + '</a><ul id="' + value.g + '"></ul></li>');
		$.each(value.web, function(n, value) {
			if (value.u != undefined && value.hide == undefined)
				$("#" + group).append('<li esOpenVaule="' + value.u + '"><a href="#">' + value.n + '</a></li>');
		});
	});

	$("li").click(function() {
		var urlframe = $(this).attr("esVaule");
		var urlopen = $(this).attr("esOpenVaule");
		if (urlopen != undefined) {
			window.open(urlopen);
		}
		if (urlframe != undefined) {
			$("#viewer", parent.document.body).attr("src", urlframe);
			$('li').removeClass("current");
			$(".menu .hover").addClass("current");
		}
	});

	$('a[rel*=leanModal]').leanModal({
		top: 200,
		closeButton: ".modal_close"
	});

	/*
	99Lime.com HTML KickStart by Joshua Gatcke
	kickstart.js
	*/
	$('ul.menu').each(function(){
		// add the menu toggle
		$(this).prepend('<li class="menu-toggle"><a href="#"><span class="icon" data-icon="Y"></span> Menu</a></li>');

		// find menu items with children.
		$(this).find('li').has('ul').addClass('has-menu')
		.find('a:first').append('<span class="arrow">&nbsp;</span>');
	});
	$('ul.menu li').hover(function(){
		$(this).find('ul:first').stop(true, true).fadeIn('fast');
		$(this).addClass('hover');
	},		
	function(){
		$(this).find('ul').stop(true, true).fadeOut('slow');
		$(this).removeClass('hover');
	});
	$('ul').find('li:first-child').addClass('first');
	$('ul').find('li:last-child').addClass('last');

	gengrid();
	
	$('#searchtext').bind('keypress', function(event) {
		if (event.keyCode == "13") {
			self.location = "https://www.baidu.com/s?wd=" + encodeURIComponent($('#searchtext').val());
		}
	});
	
	$('#btn_bd').click(function(){
//		self.location = "https://www.baidu.com/s?wd=" + encodeURIComponent($('#searchtext').val());
	window.open("https://www.baidu.com/s?wd=" + encodeURIComponent($('#searchtext').val()), "_blank");
	
	});
	
	$('#btn_gg').click(function(){
//		self.location = "https://www.google.com.hk/?gws_rd=cr,ssl&safe=strict&q=" + encodeURIComponent($('#searchtext').val());
//		self.location = "https://duliziyou.com/search?q=" + encodeURIComponent($('#searchtext').val());
		// window.open("https://www.google.com.hk/?gws_rd=cr,ssl#newwindow=1&safe=strict&, "_blank");
		googleStr = "/search?hl=zh-CN&q=" + encodeURIComponent($('#searchtext').val());
		trygoogle(0);
	});
	
	$('#btn_lib').click(function(){
		var actionURL = "http://202.206.242.99/opac/openlink.php?strSearchType=title&match_flag=forward&historyCount=1&strText=" + encodeURIComponent($('#searchtext').val()) + "&doctype=ALL&displaypg=20&showmode=list&sort=CATA_DATE&orderby=desc&location=ALL";
		window.open(actionURL, "_blank");
	});


	console.info("           ES           \n       做一个环保的人\n============================\nPowered by\nhttp://www.littleji.com\nhttp://www.xiaobaidonghui.cn\n\n In YanShan University 2015\n============================");
});


// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL

(function($) {
	$.fn.extend({
		leanModal: function(options) {
			var defaults = {
				top: 100,
				overlay: 0.5,
				closeButton: null
			};
			var overlay = $("div#lean_overlay");
			$("body").append(overlay);
			options = $.extend(defaults, options);
			return this.each(function() {
				var o = options;
				$(this).click(function(e) {
					var modal_id = $(this).attr("href");
					$("#lean_overlay").click(function() {
						close_modal(modal_id)
					});
					$(o.closeButton).click(function() {
						close_modal(modal_id)
					});
					var modal_height = $(modal_id).outerHeight();
					var modal_width = $(modal_id).outerWidth();
					$("#lean_overlay").css({
						"display": "block",
						opacity: 0
					});
					$("#lean_overlay").fadeTo(200, o.overlay);
					$(modal_id).css({
						"display": "block",
						"position": "fixed",
						"opacity": 0,
						"z-index": 11000,
						"left": 50 + "%",
						"margin-left": -(modal_width / 2) + "px",
						"top": o.top + "px"
					});
					$(modal_id).fadeTo(200, 1);
					e.preventDefault()
				})
			});

			function close_modal(modal_id) {
				$("#lean_overlay").fadeOut(200);
				$(modal_id).css({
					"display": "none"
				})
			}
		}
	})
})(jQuery);


var hs = ["go.hibenben.com","www.hlfeel.com","g.yon.hk","www.guge119.com","www.ggooo.net"];   
var googleStr = "";

function getRandomInt(min, max) {
	return Math.floor(Math.random() * (max - min + 1)) + min;
}

function red(h) {
	var l = 'http://' + h + googleStr;
	window.location = l;
}

var stop = false;
function trygoogle(i) {
	var h = hs[i];
	red(h);
	i++;
	if (i >= hs.length) {
		stop = true;
		i = 0;
	}
	if (stop) {
		return;
	}
	setTimeout(function() { load(i); }, 500);
}
